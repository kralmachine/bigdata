{"paragraphs":[{"text":"%livy2.spark\nsc.version","user":"admin","dateUpdated":"2017-10-15T05:54:59+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<font color=\"red\">Previous livy session is expired, new livy session is created. Paragraphs that depend on this paragraph need to be re-executed!</font>"},{"type":"TEXT","data":"res0: String = 2.1.1.2.6.2.0-205"}]},"apps":[],"jobName":"paragraph_1507662868028_1737403048","id":"20171010-221428_184825189","dateCreated":"2017-10-10T22:14:28+0300","dateStarted":"2017-10-15T05:54:59+0300","dateFinished":"2017-10-15T05:55:55+0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3020"},{"text":"val myrange = sc.range(0,1000,1).toDF(\"number\")","user":"admin","dateUpdated":"2017-10-15T06:02:35+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myrange: org.apache.spark.sql.DataFrame = [number: bigint]"}]},"apps":[],"jobName":"paragraph_1507663853416_-280054384","id":"20171010-223053_2101883109","dateCreated":"2017-10-10T22:30:53+0300","dateStarted":"2017-10-15T06:02:35+0300","dateFinished":"2017-10-15T06:02:45+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3021"},{"text":"myrange.show()","user":"admin","dateUpdated":"2017-10-15T06:27:35+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+\n|number|\n+------+\n|     0|\n|     1|\n|     2|\n|     3|\n|     4|\n|     5|\n|     6|\n|     7|\n|     8|\n|     9|\n|    10|\n|    11|\n|    12|\n|    13|\n|    14|\n|    15|\n|    16|\n|    17|\n|    18|\n|    19|\n+------+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1508036519781_1465863146","id":"20171015-060159_495975303","dateCreated":"2017-10-15T06:01:59+0300","dateStarted":"2017-10-15T06:04:05+0300","dateFinished":"2017-10-15T06:04:11+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3022"},{"text":"val divisBy2 = myrange.where(\"number % 2 = 0\")","user":"admin","dateUpdated":"2017-10-15T06:27:01+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"divisBy2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [number: bigint]"}]},"apps":[],"jobName":"paragraph_1508036605870_694315719","id":"20171015-060325_1082153330","dateCreated":"2017-10-15T06:03:25+0300","dateStarted":"2017-10-15T06:27:02+0300","dateFinished":"2017-10-15T06:27:08+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3023"},{"text":"divisBy2.count()","user":"admin","dateUpdated":"2017-10-15T06:33:18+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: Long = 500"}]},"apps":[],"jobName":"paragraph_1508038021935_-351497793","id":"20171015-062701_562609077","dateCreated":"2017-10-15T06:27:01+0300","dateStarted":"2017-10-15T06:33:18+0300","dateFinished":"2017-10-15T06:33:25+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3024"},{"text":"/* csv okumak*/\nval flightData2015 = spark.read.option(\"inferSchema\",\"true\").option(\"header\",\"true\").csv(\"hdfs://node1.datalonga.com:8020/user/erkan/veri_setlerim/2015-summary.csv\")","user":"admin","dateUpdated":"2017-10-15T07:09:52+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"flightData2015: org.apache.spark.sql.DataFrame = [DEST_COUNTRY_NAME: string, ORIGIN_COUNTRY_NAME: string ... 1 more field]"}]},"apps":[],"jobName":"paragraph_1508038398247_-218037541","id":"20171015-063318_1001464204","dateCreated":"2017-10-15T06:33:18+0300","dateStarted":"2017-10-15T07:09:14+0300","dateFinished":"2017-10-15T07:09:24+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3025"},{"text":"flightData2015.take(3)","user":"admin","dateUpdated":"2017-10-15T07:11:11+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res6: Array[org.apache.spark.sql.Row] = Array([United States,Romania,15], [United States,Croatia,1], [United States,Ireland,344])"}]},"apps":[],"jobName":"paragraph_1508040191649_-413716033","id":"20171015-070311_1513413617","dateCreated":"2017-10-15T07:03:11+0300","dateStarted":"2017-10-15T07:11:11+0300","dateFinished":"2017-10-15T07:11:14+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3026"},{"text":"flightData2015.show()","user":"admin","dateUpdated":"2017-10-15T07:29:42+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-------------------+-----+\n|   DEST_COUNTRY_NAME|ORIGIN_COUNTRY_NAME|count|\n+--------------------+-------------------+-----+\n|       United States|            Romania|   15|\n|       United States|            Croatia|    1|\n|       United States|            Ireland|  344|\n|               Egypt|      United States|   15|\n|       United States|              India|   62|\n|       United States|          Singapore|    1|\n|       United States|            Grenada|   62|\n|          Costa Rica|      United States|  588|\n|             Senegal|      United States|   40|\n|             Moldova|      United States|    1|\n|       United States|       Sint Maarten|  325|\n|       United States|   Marshall Islands|   39|\n|              Guyana|      United States|   64|\n|               Malta|      United States|    1|\n|            Anguilla|      United States|   41|\n|             Bolivia|      United States|   30|\n|       United States|           Paraguay|    6|\n|             Algeria|      United States|    4|\n|Turks and Caicos ...|      United States|  230|\n|       United States|          Gibraltar|    1|\n+--------------------+-------------------+-----+\nonly showing top 20 rows"}]},"apps":[],"jobName":"paragraph_1508040662211_-1105067123","id":"20171015-071102_895777734","dateCreated":"2017-10-15T07:11:02+0300","dateStarted":"2017-10-15T07:12:39+0300","dateFinished":"2017-10-15T07:12:40+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3027"},{"text":"/* Spark'ın transformasyon planını görebiliriz. Bunun için DF transformation operasyonu sonuna explain() metodunu eklememiz yeterlidir. Bu biraz gizemlidir pek kimse bilmez ancak biraz kullanıca alışkanlık kazanırsınız.\nEn üstte sonuç en altta da veri kaynağı vardır. Yani sonuçtan kaynağa doğrudur gördükleriniz. Debug ve optimizasyon için de kullanılabilir.*/\nflightData2015.sort(\"count\").explain()","user":"admin","dateUpdated":"2017-10-15T07:21:43+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"== Physical Plan ==\n*Sort [count#21 ASC NULLS FIRST], true, 0\n+- Exchange rangepartitioning(count#21 ASC NULLS FIRST, 200)\n   +- *FileScan csv [DEST_COUNTRY_NAME#19,ORIGIN_COUNTRY_NAME#20,count#21] Batched: false, Format: CSV, Location: InMemoryFileIndex[hdfs://node1.datalonga.com:8020/user/erkan/veri_setlerim/2015-summary.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<DEST_COUNTRY_NAME:string,ORIGIN_COUNTRY_NAME:string,count:int>"}]},"apps":[],"jobName":"paragraph_1508040759337_-1029317562","id":"20171015-071239_541654255","dateCreated":"2017-10-15T07:12:39+0300","dateStarted":"2017-10-15T07:16:29+0300","dateFinished":"2017-10-15T07:16:31+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3028"},{"text":"/* Bu planı basit bir action ile tetikleyelim*/\nflightData2015.sort(\"count\").take(2)","user":"admin","dateUpdated":"2017-10-15T07:24:48+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res10: Array[org.apache.spark.sql.Row] = Array([United States,Singapore,1], [Moldova,United States,1])"}]},"apps":[],"jobName":"paragraph_1508040989830_582717388","id":"20171015-071629_1628372003","dateCreated":"2017-10-15T07:16:29+0300","dateStarted":"2017-10-15T07:24:48+0300","dateFinished":"2017-10-15T07:24:51+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3029"},{"title":"Dataframes and SQL","text":"/* SQL ile çalışmadan önce Spark DataFrame'i geçici bir tablo veya view olarak kaydeder. SQL sorguları bu geçici tablo veya view üzerinden gerçekleşir. Ancak aslında geri planda bu SQL soruları veya Spark kodları ile yapılmak istenen şey\naynıdır. Hiç bir performans farkı yoktur.*/","user":"admin","dateUpdated":"2017-10-15T07:33:34+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Error with 400 StatusCode: \"Invalid UTF-8 middle byte 0x61\\n at [Source: HttpInputOverHTTP@78782168; line: 2, column: 25]\""}]},"apps":[],"jobName":"paragraph_1508041488663_-566251217","id":"20171015-072448_387048836","dateCreated":"2017-10-15T07:24:48+0300","dateStarted":"2017-10-15T07:33:34+0300","dateFinished":"2017-10-15T07:33:35+0300","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3030"},{"title":"Geçici Tablo Oluşturma","text":"flightData2015.createOrReplaceTempView(\"tablo_flightData2015\")","user":"admin","dateUpdated":"2017-10-15T07:35:35+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1508042014940_1465020472","id":"20171015-073334_1972188536","dateCreated":"2017-10-15T07:33:34+0300","dateStarted":"2017-10-15T07:35:35+0300","dateFinished":"2017-10-15T07:35:38+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3031"},{"title":"Geçici Tablo Üzerinde SQL Sorguları","user":"admin","dateUpdated":"2017-10-15T07:36:32+0300","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1508042135583_1085775193","id":"20171015-073535_1982968639","dateCreated":"2017-10-15T07:35:35+0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3032"}],"name":"ScalaWorks/databricksBook","id":"2CWPUJK6H","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}